#!/usr/bin/env bash
# SHELL CONFIGURATION:
# 	- shared among multiple shells
# 	- represents my personal/opinionated approach to using the terminal
# 	- Contains:
# 		- Enviroment Variables
# 		- Jump to Directories 
# 		- Usage Aliases (added based on if app is installed)


export SHELL_NAME=${1:-"zsh"}

export MANPAGER="sh -c 'col -bx | bat -l man -p'"
export MANROFFOPT="-c"
export PAGER="less -imMWR"

export EDITOR="hx"
export VISUAL="zed"

export XDG_STATE_HOME=$HOME/.local/state
export XDG_DATA_HOME=$HOME/.local/share
export XDG_CACHE_HOME=$HOME/.local/cache
export XDG_CONFIG_HOME=$HOME/.config

export ICLOUD="$HOME/Library/Mobile Documents/com~apple~CloudDocs/Documents"

export SOURCE="$HOME/Source"
export SOURCE_GITHUB="$SOURCE/github.com"
export SOURCE_GITCJ="$SOURCE/gitlab.cj.dev"
export SOURCE_JEFF="$SOURCE/github.com/jeffwindsor"
export DOTFILES="$SOURCE_JEFF/dotfiles"
export DOCKER_FILES="$SOURCE_JEFF/docker-images"
export NIXCONFIG="$SOURCE_JEFF/nix-config"
export NIXSHELLS="$NIXCONFIG/shells"  # no longer a separate repo
export REPOS_TO_SYNC=("$DOTFILES")

#== Jump to Directories (prefer this over zoxide)
alias la="ls -a --color=auto"
alias ll="ls -l --color=auto"
alias lla="ls -la --color=auto"
alias l="clear && lla"

alias .....="cd ../../../../"
alias ....="cd ../../../"
alias ...="cd ../../"
alias ..="cd .."
alias icloud="cd $ICLOUD && l"
alias c="clear"
# clear and return to HOME
alias cc="cd && clear"
alias config="cd $XDG_CONFIG_HOME && l"
alias hub="cd $SOURCE_GITHUB && l"
alias lab="cd $SOURCE_GITCJ && l"
alias empire="cd $SOURCE_GITCJ/empire && l"
alias jeff="cd $SOURCE_JEFF && l"
# helps remote servers when using advanced terminals like ghostty and alacritty 
alias ssh="term=xterm-256color ssh"

# create aliases for cd, edit, visual-edit and lazygit (if contains .git)
function alias-dir() {
	alias "${1}"="cd $2 && l"
	alias "${1}e"="\$EDITOR $2"
	alias "${1}v"="\$VISUAL $2"

	# lazygit only if repo
	if [ -d "${2}/.git" ]; then
		alias "${1}g"="lazygit --path $2"
	fi
}
alias-dir "d" "$DOTFILES" 

# source shellrc
alias ss="source \$HOME/.shellrc"
# edit shellrc, shared aliases and functions
alias ds="\$EDITOR \$HOME/.config/shellrc/"

# function not needed outside this script
unset -f alias-dir


#== load program aliases
for f in $XDG_CONFIG_HOME/shellrc/*.rc; do
	source $f
done
#== load local machine specific shell configuration and overrides
[ -f "$HOME/.shellrc.local" ] && source "$HOME/.shellrc.local"
